language: shell
os: linux
dist: bionic

git:
  depth: false

# https://docs.travis-ci.com/user/caching/ (nothing to cache)
before_script:
- 'sudo apt update; sudo apt install -y libguestfs-tools sshpass sshfs qemu-system-arm qemu-block-extra qemu-utils' 
- |
    url=https://raw.githubusercontent.com/devizer/glist/master/install-dotnet-dependencies.sh; (wget -q -nv --no-check-certificate -O - $url 2>/dev/null || curl -ksSL $url) | bash
    script=https://raw.githubusercontent.com/devizer/glist/master/install-dotnet-and-nodejs.sh; (wget -q -nv --no-check-certificate -O - $script 2>/dev/null || curl -ksSL $script) | bash -s pwsh

script:
- sudo pwsh image-builder.ps1
